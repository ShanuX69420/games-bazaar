{% load time_filters %}

<div class="d-flex align-items-center mb-3">
    <img src="https://i.imgur.com/v8Ld3iI.png" alt="{{ other_user.username }}" width="40" height="40" class="rounded-circle me-3">
    <div><h5 class="mb-0">{{ other_user.username }}</h5></div>
</div>

<div id="chat-log" class="border p-3 rounded" style="height: 50vh; overflow-y: scroll; background-color: #f8f9fa;">
    {% for message in messages %}
        {% if message.is_system_message %}
        <div class="mb-3">
            <div class="d-flex justify-content-between">
                <div><strong>Gamers Market</strong><span class="badge bg-primary ms-1">notification</span></div>
                <small class="text-muted">{{ message.timestamp|smart_time }}</small>
            </div>
            <div class="p-2 mt-1" style="background-color: #eef2fa; border-left: 3px solid #0d6efd; color: #445d89;"><i class="fas fa-info-circle me-1"></i> {{ message.content|linebreaksbr }}</div>
        </div>
        {% else %}
        <div class="mb-3">
            <div class="d-flex justify-content-between">
                <strong>{{ message.sender.username }}</strong>
                <small class="text-muted">{{ message.timestamp|smart_time }}</small>
            </div>
            <p class="mb-0 text-break">{{ message.content|linebreaksbr }}</p>
        </div>
        {% endif %}
    {% endfor %}
</div>

<form id="chat-form" class="mt-3">
    <div class="input-group">
        <input id="chat-message-input" type="text" class="form-control" placeholder="Type a message...">
        <button id="chat-message-submit" class="btn btn-primary">Send</button>
    </div>
</form>